<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Homework 1</title>

    <!-- Load Bulma from CDN (consider saving it to repository instead) -->
    <!-- https://bulma.io/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">

    <!-- Load Font Awesome 5 (free) icons -->
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </head>

  <body>

  <!-- Page header -->
  <!-- https://bulma.io/documentation/layout/hero/ -->
  <section class="hero is-warning is-bold">
    <div class="hero-body">
      <div class="container">
        <h1 class="title">Homework 1</h1>
        <h2 class="subtitle">Tableau and D3</h2>
      </div>
    </div>
  </section>
  <!-- End page header -->

  <!-- Page navigation -->
  <!-- https://bulma.io/documentation/components/navbar/ -->
  <nav class="navbar is-light" role="navigation" aria-label="main navigation">
    <div class="container">
      <div class="navbar-brand">
        <!-- TODO: Change link to repository homepage if needed -->
        <!-- TODO: Change which navbar-item is-active if needed -->
        <a class="navbar-item is-active" href="index.html">
          <span class="icon"><i class="fas fa-home"></i></span>
          <span>Home</span>
        </a>

        <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="main-menu">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>

      <div id="main-menu" class="navbar-menu has-text-weight-medium">
        <!-- Left navbar items -->
        <div class="navbar-start">
          <!-- <a class="navbar-item" href="#data" title="Data">
            <span class="icon"><i class="fas fa-table"></i></span>
            <span>Data</span>
          </a> -->

          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Visualizations
            </a>

            <div class="navbar-dropdown">
              <a class="navbar-item" href="lineChart.html">
                <span class="icon"><i class="fas fa-chart-line"></i></span>
                <span>Line Chart</span>
              </a>

              <a class="navbar-item" href="barChart.html">
                <span class="icon"><i class="fas fa-chart-bar"></i></span>
                <span>Bar Chart</span>
              </a>

              <hr class="navbar-divider">

              <a class="navbar-item" href="areaChart.html">
                <span class="icon"><i class="fas fa-chart-area"></i></span>
                <span>Area Chart</span>
              </a>
              <!-- <a class="navbar-item">
                <span class="icon"><i class="fas fa-chart-pie"></i></span>
                <span>Pie Chart</span>
              </a> -->
            </div>
          </div>
        </div>

        <!-- Right navbar items -->
        <div class="navbar-end">
          <a class="navbar-item" href="#about" title="About">
            <span class="icon"><i class="fas fa-info-circle"></i></span>
            <span>About</span>
          </a>
        </div>
      </div>
    </div>
  </nav>
  <!-- End page navigation -->

  <section class="section">
    <div class="container">
      <!-- Begin page content -->
      <div class="content">
        <h1 class="title">
          BarChart Visualization
        </h1>

        <h2 id="data">Purpose</h2>
        <p>This barchart visualization is to view the trends of total passengers flying through SFO Airport from 2005 to 2019 (as of February 2020).</p>

        <h2 id="data">Wrangling</h2>
        <p>For this bar chart the data was filtered using Activity Period and Passenger Count from <a href=https://data.sfgov.org/Transportation/Air-Traffic-Passenger-Statistics/rkru-6vcg/>Data SF</a>.
          <br>The used .csv file can be found <a href="https://github.com/usf-cs360-spring2020/homework1-Lelionbear">here</a>.</p>

        <h2 id="data">Tableau</h2>
        <figure >
        <img  src="GRAPH_1.png"></img>
        </figure>

        <h2 id="data">d3.js</h2>
        <svg></svg>

        <br>
        <br>
        <p>Data set was taken from <a href=https://data.sfgov.org/Transportation/Air-Traffic-Passenger-Statistics/rkru-6vcg/>Data SF</a> and shows the Air Traffic Passenger Statistics for the San Francisco international airport.</br>
        Data period from July 2005 to September 2019 (as of this date in February 2020)</p>

        <h2 id="data">Analysis</h2>
        <p>Passenger count is encoded as the length of a bar thus longer bars represent higher passenger count.
        <br>Date/Year is represented as the x-axis, so time period can be observed linearly.
        <br>
        <br>
        From this bar chart we can see that flights in SFO has been incrementing at a steady rate each year.
        Two conclusions that can be made from this data. First, the spike downwards from 2019 can be caused by higher price rates airlines sell.
        Second, SFO has become a major node in the plane transit ecosystem as it takes part of the silicon valley tech hub.
        </p>



        <h2 id="about">About</h2>

        <!-- Profile box -->
        <!-- https://bulma.io/documentation/layout/media-object/ -->
        <article class="media">
          <figure class="media-left">
            <p class="image is-128x128"><img class="is-rounded" src="profile_pic.JPG"></p>
          </figure>

          <div class="media-content">
            <div class="content">
              <p>
                <strong>Arturo Galvan-Alarcon</strong><br/>
                CS Major, <a href="https://www.usfca.edu/">University of San Francisco</a><br/>
                <em>Expected Graduation: 2021</em><br/>
                <i class="fas fa-envelope"></i> <a href="mailto:agalvanalarcon@dons.usfca.edu">agalvanalarcon@dons.usfca.edu</a>
              </p>

              <p>
                Puzzle solver, Reddit surfer (and my only source for cooking recipes).
                Passionate about building and working with Robotics, aiming to learn all about CS to integrate AI into Robotics.
              </p>

              <!-- https://bulma.io/documentation/elements/tag/ -->
              <div class="heading">Skills</div>

              <div class="tags">
                <span class="tag">Python</span>
                <span class="tag">C</span>
                <span class="tag">Java</span>
                <span class="tag">JavaScript</span>
                <span class="tag">HTML</span>
                <span class="tag">CSS</span>
                <span class="tag">SVG</span>
              </div>
            </div>
          </div>
        </article>
        <!-- End profile box -->

      </div>
      <!-- End page content -->
    </div>
  </section>

  <!-- Page footer -->
  <!-- https://bulma.io/documentation/layout/footer/ -->
  <footer class="footer">
    <div class="content has-text-centered is-size-7">
      <p>
        <a href="#top">
          <span class="fas fa-arrow-up"></span>
          <span class="has-text-weight-medium">Back to Top</span>
        </a>
      </p>

      <p>
        <a href="https://github.com/Lelionbear" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
          <i class="fab fa-github-alt"></i>&nbsp;<strong>Github</strong>
        </a>

        <a href="https://fontawesome.com/" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
          <i class="fab fa-font-awesome"></i>&nbsp;<strong>FontAwesome</strong>
        </a>

        <a href="https://bulma.io" class="button is-small">
          <img src="https://bulma.io/images/made-with-bulma--semiblack.png" alt="Made with Bulma" width="128" height="24">
        </a>
      </p>
    </div>
  </footer>
  <!-- End page footer -->

  <!-- Mobile menu responsiveness -->
  <!-- https://bulma.io/documentation/components/navbar/ -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

    if ($navbarBurgers.length > 0) {
      $navbarBurgers.forEach( el => {
        el.addEventListener('click', () => {
          const target = el.dataset.target;
          const $target = document.getElementById(target);
          el.classList.toggle('is-active');
          $target.classList.toggle('is-active');
        });
      });
    }
  });

  //  SVG SCRIPT BELOW THIS COMMENT
  let csv = 'bararturocsv.csv';

  let config = {
    'svg': {},
    'margin': {},
    'plot': {}
  };

  config.svg.height = 450;
  config.svg.width = config.svg.height * 1.618; // golden ratio

  config.margin.top = 10;
  config.margin.right = 10;
  config.margin.bottom = 20;
  config.margin.left = 80;

  config.plot.x = config.margin.left;
  config.plot.y = config.margin.top;
  config.plot.width = config.svg.width - config.margin.left - config.margin.right;
  config.plot.height = config.svg.height - config.margin.top - config.margin.bottom;

  var margin = {top: 10, right: 10, bottom: 20, left: 80}
    , width =960
    , height = 450

  d3.csv(csv, convertRow).then(drawBarChart);

  let parseColumnName = d3.timeParse('%Y-%m');

  function convertRow(row, index) {
    let out = {};

    for (let col in row) {

      switch (col) {
        case 'Passenger Count':
          out[col] = row[col];
          break;

        case 'Year of Date':
          var d = row[col].substring(0,4) + "-" + row[col].substring(4,6);
          var date = parseColumnName(d);
          // console.log(col);

          // convert the value to float
          var value = parseFloat(row[col].substring(0,4));

          out[col] = value;

          break;
        // these should be our time series values
        default:
          // console.log("IN DEFAULT");
      }
    }

    return out;
  }

  // var x_scale = d3.scaleBand().range([0, config.plot.width]);
  // var y_scale = d3.scaleLinear().range([config.plot.height, 0]);

  var x_scale = d3.scaleBand()
      .range([0, width])

  var y_scale = d3.scaleLinear()
      .range([height, 0])
  var svg;

  function drawBarChart(data) {
    // console.log(data);

    let passenger_count = data.map(row => row['Passenger Count']);
    // console.log(passenger_count);

    let dates = data.map(row => row['Year of Date']).filter(
      (value, index, self) => {return self.indexOf(value) === index}
    );
    // console.log(dates);

    dates = dates.sort()
    let maxPassengers = d3.max(passenger_count);
    x_scale.domain(dates);
    y_scale.domain([0,maxPassengers]);

    // get the svg to draw on
    // svg = d3.select("body").select("svg")
    //   .attr("width", config.plot.width + config.margin.left + config.margin.right)
    //   .attr("height", config.plot.height + config.margin.bottom + config.margin.top)
    //   .append("g")
    //   .attr("transform", "translate(0" + (config.margin.left - 50) + "," + config.margin.top + ")"); // start of svg


    svg = d3.select("body").select("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      // .attr("transform", "translate(0," + config.plot.height + ")")
      .call(d3.axisBottom(x_scale));

    svg.append("g")
      .attr("class", "y axis")
      .call(d3.axisLeft(y_scale).ticks(10,"f").tickFormat(d3.formatPrefix(".0", 1e5)));

    svg.selectAll(".bar")
      .data(data)
        .enter().append("rect")
          .attr("class", "bar")
          .attr("x", function(d, i) { return x_scale(d['Year of Date']) })
          .attr("y", function(d) { return y_scale(d['Passenger Count']) })
          .attr("width", x_scale.bandwidth())
          .attr("height", function(d) { return height - y_scale(d['Passenger Count']) })
  }
  </script>
  <!-- End mobile menu responsiveness -->
  </body>

</html>
